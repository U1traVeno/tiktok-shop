syntax = "proto3";

package product;

import "api.proto";

option go_package = "/product";

// ProductCatalogService 定义了与商品相关的 RPC 服务
service ProductHandler {
  // ListProducts 获取带分页的商品列表
  rpc ListProducts(ListProductsReq) returns (ListProductsResp) {
    option (api.get) = "/products";
  }

  // GetProduct 根据 ID 获取单个商品
  rpc GetProduct(GetProductReq) returns (GetProductResp) {
    option (api.get) = "/products/{id}";
  }

  // SearchProducts 根据查询字符串搜索商品
  rpc SearchProducts(SearchProductsReq) returns (SearchProductsResp) {
    option (api.get) = "/products/search";
  }

  // CreateProduct 创建新商品
  rpc CreateProduct(CreateProductReq) returns (CreateProductResp) {
    option (api.post) = "/products";
  }

  // UpdateProduct 更新商品信息
  rpc UpdateProduct(UpdateProductReq) returns (UpdateProductResp) {
    option (api.put) = "/products/{id}";
  }

  // DeleteProduct 删除商品
  rpc DeleteProduct(DeleteProductReq) returns (DeleteProductResp) {
    option (api.delete) = "/products/{id}";
  }
}

// ListProductsReq 是获取商品列表的请求消息
message ListProductsReq {
  int32 page = 1;         // 分页页码
  int32 pageSize = 2;     // 每页商品数量
  repeated string  categoryName = 3; // 按类别名称过滤
}

// Product 表示商品信息
message Product {
  uint32 id = 1;           // 商品唯一标识
  string name = 2;         // 商品名称
  string description = 3;  // 商品描述
  string picture = 4;      // 商品图片 URL
  float price = 5;         // 商品价格
  int32 amount = 6;        // 商品数量
  repeated string categories = 7; // 商品所属类别
}

// ListProductsResp 是获取商品列表的响应消息
message ListProductsResp {
  repeated Product products = 1; // 商品列表
  int32 status_code = 2[(api.go_tag)='json:"status_code"'];
  string status_msg = 3;
}

// GetProductReq 是获取单个商品的请求消息
message GetProductReq {
  uint32 id = 1; // 要获取的商品 ID
}

// GetProductResp 是获取单个商品的响应消息
message GetProductResp {
  Product product = 1; // 获取到的商品
  int32 status_code = 2[(api.go_tag)='json:"status_code"'];
  string status_msg = 3;
}

// SearchProductsReq 是搜索商品的请求消息
message SearchProductsReq {
  string query = 1; // 搜索查询字符串
}

// SearchProductsResp 是搜索商品的响应消息
message SearchProductsResp {
  repeated Product results = 1; // 匹配搜索查询的商品列表
  int32 status_code = 2[(api.go_tag)='json:"status_code"'];
  string status_msg = 3;
}

// CreateProductReq 是创建商品的请求消息
message CreateProductReq {
  string name = 1;         // 商品名称
  string description = 2;  // 商品描述
  string picture = 3;      // 商品图片 URL
  float price = 4;         // 商品价格
  int32 amount = 5;        // 商品数量
  repeated string categories = 6; // 商品所属类��
  int32 id=7;//商品id
}

// CreateProductResp 是创建商品的响应消息
message CreateProductResp {
  Product product = 1; // 创建的商品
  int32 status_code = 2[(api.go_tag)='json:"status_code"'];
  string status_msg = 3;
}

// UpdateProductReq 是更新商品的请求消息
message UpdateProductReq {
  uint32 id = 1;           // 商品唯一标识
  string name = 2;         // 商品名称
  string description = 3;  // 商品描述
  string picture = 4;      // 商品图片 URL
  float price = 5;         // 商品价格
  int32 amount = 6;        // 商品数量
  repeated string categories = 7; // 商品所属类别
}

// UpdateProductResp 是更新商品的响应消息
message UpdateProductResp {
  Product product = 1; // 更新的商品
  int32 status_code = 2[(api.go_tag)='json:"status_code"'];
  string status_msg = 3;
}

// DeleteProductReq 是删除商品的请求消息
message DeleteProductReq {
  uint32 id = 1; // 要删除的商品 ID
}

// DeleteProductResp 是删除商品��响应消息
message DeleteProductResp {
  string message = 1; // 删除结果消息
  int32 status_code = 2[(api.go_tag)='json:"status_code"'];
  string status_msg = 3;
}